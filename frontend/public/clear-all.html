<!DOCTYPE html>
<html>
<head>
    <title>ğŸ§¹ Safari ì™„ì „ ìºì‹œ ì •ë¦¬</title>
    <meta charset="UTF-8">
</head>
<body>
    <h1>ğŸ§¹ Safari ì™„ì „ ìºì‹œ ì •ë¦¬</h1>
    <p>Safariì˜ ëª¨ë“  ìºì‹œë¥¼ ê°•ì œë¡œ ì •ë¦¬í•©ë‹ˆë‹¤</p>
    <div id="status">ì§„í–‰ ì¤‘...</div>
    
    <script>
    (async function() {
        const statusDiv = document.getElementById('status');
        
        function log(message) {
            console.log(message);
            statusDiv.innerHTML += '<div>' + message + '</div>';
        }
        
        try {
            log('ğŸ” Safari ìºì‹œ ì •ë¦¬ ì‹œì‘...');
            
            // Service Worker ì •ë¦¬
            if ('serviceWorker' in navigator) {
                const regs = await navigator.serviceWorker.getRegistrations();
                log(`ğŸ“‹ Service Worker: ${regs.length}ê°œ ë°œê²¬`);
                
                for (const reg of regs) {
                    await reg.unregister();
                    log(`âœ… Service Worker ì œê±°: ${reg.scope}`);
                }
            }
            
            // ëª¨ë“  ìºì‹œ ì •ë¦¬
            if ('caches' in window) {
                const cacheNames = await caches.keys();
                log(`ğŸ“¦ ìºì‹œ: ${cacheNames.length}ê°œ ë°œê²¬`);
                
                for (const name of cacheNames) {
                    await caches.delete(name);
                    log(`ğŸ—‘ï¸ ìºì‹œ ì‚­ì œ: ${name}`);
                }
            }
            
            // ì €ì¥ì†Œ ì •ë¦¬
            localStorage.clear();
            sessionStorage.clear();
            log('ğŸ§½ localStorage, sessionStorage ì •ë¦¬ ì™„ë£Œ');
            
            // IndexedDB ì •ë¦¬
            if ('indexedDB' in window) {
                try {
                    const databases = await indexedDB.databases();
                    for (const db of databases) {
                        const deleteReq = indexedDB.deleteDatabase(db.name);
                        log(`ğŸ—„ï¸ IndexedDB ì‚­ì œ: ${db.name}`);
                    }
                } catch(e) {
                    log('â„¹ï¸ IndexedDB ì •ë¦¬ ê±´ë„ˆëœ€');
                }
            }
            
            log('âœ… ëª¨ë“  ì •ë¦¬ ì‘ì—… ì™„ë£Œ!');
            log('âš ï¸ ì´ì œ Safarië¥¼ ì™„ì „íˆ ì¢…ë£Œí•œ í›„ ë‹¤ì‹œ ì—´ì–´ì£¼ì„¸ìš”');
            
            // 3ì´ˆ í›„ ë©”ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
            setTimeout(() => {
                log('ğŸ”„ ë©”ì¸ í˜ì´ì§€ë¡œ ì´ë™...');
                window.location.replace(`/?safari-clear=${Date.now()}`);
            }, 3000);
            
        } catch (error) {
            log(`âŒ ì—ëŸ¬ ë°œìƒ: ${error.message}`);
            console.error('Safari ìºì‹œ ì •ë¦¬ ì¤‘ ì—ëŸ¬:', error);
        }
    })();
    </script>
    
    <p><strong>ì°¸ê³ :</strong> Safariì˜ ìºì‹œëŠ” ë§¤ìš° ê°•ë ¥í•˜ë¯€ë¡œ ì™„ì „í•œ ì •ë¦¬ë¥¼ ìœ„í•´ Safarië¥¼ ì™„ì „íˆ ì¢…ë£Œí•œ í›„ ë‹¤ì‹œ ì—´ì–´ì£¼ì„¸ìš”.</p>
</body>
</html>