# 고객관리 시스템 확장 PRD
## Enhanced Customer Management System

---

## 📋 문서 정보

- **작성일**: 2025-06-06
- **버전**: 1.0
- **작성자**: Claude Code Assistant
- **승인자**: 사용자 검토 필요
- **관련 문서**:
  - [기존 PRD](./prd.md)
  - [시스템 개요](./system-overview.md)

---

## 🎯 프로젝트 개요

### 배경
현재 고객관리 시스템은 기본적인 고객 정보 관리에 중점을 두고 있으나, 확장된 서비스(브레인, 펄스, 림프, 레드, AI바이크) 관리와 통합된 고객 경험 제공이 필요합니다.

### 목표
기존 고객관리 시스템을 확장하여 서비스 이용 내역, 패키지 관리, 개인화된 서비스 추천을 포함한 통합적 고객 관리 플랫폼을 구축합니다.

### 핵심 가치 제안
1. **통합 관리**: 고객 정보와 서비스 이력을 한 곳에서 관리
2. **개인화**: 고객별 맞춤 서비스 추천 및 관리
3. **효율성**: 직관적인 UI로 업무 효율성 극대화
4. **데이터 기반 의사결정**: 고객 분석을 통한 운영 최적화

---

## 🎨 UI/UX 설계

### 1. 메인 고객 테이블 확장

#### 1.1 현재 테이블 (유지)
```
┌─────────┬──────────┬──────────┬──────┬──────────┬──────────┬────────┐
│ 이름    │ 연락처   │ 첫방문일 │ 지역 │ 유입경로 │ 담당자   │ 액션   │
├─────────┼──────────┼──────────┼──────┼──────────┼──────────┼────────┤
│ 김영희  │ 010-1234 │ 24.01.15 │ 강남 │ 인스타   │ 이직원   │ [편집] │
└─────────┴──────────┴──────────┴──────┴──────────┴──────────┴────────┘
```

#### 1.2 확장 테이블 (추가)
```
┌─────────┬──────────┬──────────┬──────┬──────────┬──────────┬──────────┬──────────┬──────────┬────────┐
│ 이름    │ 연락처   │ 첫방문일 │ 지역 │ 유입경로 │ 담당자   │ 최근방문 │ 총방문   │ 활성패키지│ 액션   │
├─────────┼──────────┼──────────┼──────┼──────────┼──────────┼──────────┼──────────┼──────────┼────────┤
│ 김영희  │ 010-1234 │ 24.01.15 │ 강남 │ 인스타   │ 이직원   │ 24.05.30 │ 12회     │ 프리미엄 │ [상세] │
│         │ -5678    │          │      │          │          │          │          │ (브5펄3) │        │
└─────────┴──────────┴──────────┴──────┴──────────┴──────────┴──────────┴──────────┴──────────┴────────┘
```

### 2. 고객 상세 모달 (CustomerDetailModal)

#### 2.1 모달 구조
```
┌─────────────────────────────────────────────────────────────────┐
│ ✕ 김영희 고객 상세 정보                                         │
├─────────────────────────────────────────────────────────────────┤
│ [기본정보] [서비스이력] [패키지관리] [선호도] [분석] [추천]    │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│ [탭별 콘텐츠 영역]                                              │
│                                                                 │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│                               [닫기] [저장]                     │
└─────────────────────────────────────────────────────────────────┘
```

#### 2.2 탭별 상세 설계

##### 🔹 기본정보 탭
```
┌─────────────────┬─────────────────┐
│ 기본 정보       │ 연락 정보       │
├─────────────────┼─────────────────┤
│ 이름: 김영희    │ 전화: 010-1234  │
│ 생년: 1985년    │ 이메일: kim@... │
│ 성별: 여성      │ 주소: 서울시... │
│ 직업: 회사원    │ 비상연락처: ... │
├─────────────────┼─────────────────┤
│ 관리 정보       │ 특이 사항       │
├─────────────────┼─────────────────┤
│ 담당자: 이직원  │ 건강관심사:     │
│ 등급: VIP       │ - 스트레스 관리 │
│ 가입일: 24.01   │ - 수면 개선     │
│ 상태: 활성      │ 메모: 월 2회... │
└─────────────────┴─────────────────┘
```

##### 🔹 서비스이력 탭
```
┌──────────────────────────────────────────────────────────────┐
│ 📊 서비스 이용 요약                                          │
├──────────────────────────────────────────────────────────────┤
│ 총 방문: 12회 | 최근방문: 24.05.30 | 평균주기: 14일        │
│                                                              │
│ [브레인: 5회] [펄스: 4회] [림프: 2회] [레드: 1회] [AI바이크: 0회] │
├──────────────────────────────────────────────────────────────┤
│ 📅 최근 서비스 이력                                          │
├─────────┬──────────┬───────┬──────┬────────┬─────────────────┤
│ 날짜    │ 서비스   │ 시간  │ 만족도│ 담당자 │ 메모           │
├─────────┼──────────┼───────┼──────┼────────┼─────────────────┤
│ 24.05.30│ 브레인   │ 40분  │ ⭐⭐⭐⭐⭐│ 이직원 │ 컨디션 좋음    │
│ 24.05.15│ 펄스     │ 30분  │ ⭐⭐⭐⭐ │ 김직원 │ 순환 개선됨    │
│ 24.05.01│ 브레인   │ 40분  │ ⭐⭐⭐⭐⭐│ 이직원 │ 집중력 향상    │
└─────────┴──────────┴───────┴──────┴────────┴─────────────────┘
```

##### 🔹 패키지관리 탭
```
┌──────────────────────────────────────────────────────────────┐
│ 💎 활성 패키지                                               │
├──────────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────────┐  │
│ │ 프리미엄 케어 패키지 | 24.04.01~24.07.01 (91일 남음)   │  │
│ │ ─────────────────────────────────────────────────────── │  │
│ │ 브레인: ████████░░ 8/10회 (80%)                        │  │
│ │ 펄스:   ██████░░░░ 6/10회 (60%)                        │  │
│ │ 림프:   ████░░░░░░ 4/10회 (40%)                        │  │
│ │ 레드:   ██░░░░░░░░ 2/10회 (20%)                        │  │
│ │ AI바이크: ░░░░░░░░░░ 0/5회 (0%)                         │  │
│ └─────────────────────────────────────────────────────────┘  │
├──────────────────────────────────────────────────────────────┤
│ 📈 사용 패턴 분석                                            │
├──────────────────────────────────────────────────────────────┤
│ • 브레인, 펄스 서비스 선호 (이용률 70% 이상)                 │
│ • 주 1-2회 규칙적 방문 패턴                                  │
│ • 오전 시간대 예약 선호                                      │
│ • AI바이크 미이용 - 추천 필요                                │
└──────────────────────────────────────────────────────────────┘
```

##### 🔹 선호도 탭
```
┌──────────────────────────────────────────────────────────────┐
│ ⚙️ 서비스 선호 설정                                          │
├──────────────────────────────────────────────────────────────┤
│ 선호 서비스:                                                 │
│ ☑️ 브레인 (인지능력 향상)  ☑️ 펄스 (순환 개선)              │
│ ☑️ 림프 (독소 배출)        ☐ 레드 (근육 회복)               │
│ ☐ AI바이크 (유산소 운동)                                     │
│                                                              │
│ 선호 시간대:                                                 │
│ ☑️ 오전 (09:00-12:00)  ☐ 오후 (12:00-17:00)                │
│ ☐ 저녁 (17:00-21:00)                                        │
│                                                              │
│ 선호 강도:                                                   │
│ ☐ 약함  ☑️ 중간  ☐ 강함                                    │
│                                                              │
│ 건강 목표:                                                   │
│ • 스트레스 해소 및 정신 건강 개선                            │
│ • 혈액순환 개선을 통한 피로 회복                             │
│ • 규칙적인 운동 습관 형성                                    │
└──────────────────────────────────────────────────────────────┘
```

##### 🔹 분석 탭
```
┌──────────────────────────────────────────────────────────────┐
│ 📊 고객 분석 대시보드                                        │
├──────────────────────────────────────────────────────────────┤
│ 📈 방문 패턴                     💰 수익 기여                │
│ ┌─────────────────────────┐    ┌─────────────────────────┐  │
│ │    방문 횟수             │    │   월별 매출              │  │
│ │      │                  │    │     │                   │  │
│ │   12 ├──█               │    │  30만├──█                │  │
│ │    8 ├──█               │    │  20만├──█                │  │
│ │    4 ├──█               │    │  10만├──█                │  │
│ │    0 ├──────────────    │    │    0 ├──────────────     │  │
│ │      1월 2월 3월 4월 5월│    │      1월 2월 3월 4월 5월 │  │
│ └─────────────────────────┘    └─────────────────────────┘  │
│                                                              │
│ 🎯 만족도 트렌드                 ⚡ 서비스 효과               │
│ ┌─────────────────────────┐    ┌─────────────────────────┐  │
│ │ ⭐⭐⭐⭐⭐ 브레인(4.8)       │    │ 스트레스 지수: 7→4      │  │
│ │ ⭐⭐⭐⭐ 펄스(4.2)         │    │ 수면 질: 6→8            │  │
│ │ ⭐⭐⭐ 림프(3.5)           │    │ 집중력: 5→8             │  │
│ └─────────────────────────┘    └─────────────────────────┘  │
└──────────────────────────────────────────────────────────────┘
```

##### 🔹 추천 탭
```
┌──────────────────────────────────────────────────────────────┐
│ 🎯 맞춤 서비스 추천                                          │
├──────────────────────────────────────────────────────────────┤
│ 📋 이번 주 추천 스케줄                                       │
│ ┌──────────────────────────────────────────────────────────┐ │
│ │ 월요일 10:00 | 브레인 세션 (40분)                       │ │
│ │ 수요일 11:00 | 펄스 세션 (30분)                         │ │
│ │ 금요일 14:00 | AI바이크 체험 (30분) ⭐신규 추천         │ │
│ └──────────────────────────────────────────────────────────┘ │
│                                                              │
│ 💡 추천 근거                                                 │
│ • 브레인: 높은 만족도(4.8) + 스트레스 해소 목표             │
│ • 펄스: 순환 개선 효과 입증 + 정기 이용 패턴                │
│ • AI바이크: 미이용 서비스 + 운동 목표 달성                  │
│                                                              │
│ 🎁 추천 패키지                                               │
│ ┌──────────────────────────────────────────────────────────┐ │
│ │ 웰니스 플러스 패키지 (3개월)                             │ │
│ │ • 브레인 15회 + 펄스 12회 + AI바이크 8회                │ │
│ │ • 현재 이용 패턴 기반 최적화                             │ │
│ │ • 15% 할인 적용 (48만원 → 41만원)                       │ │
│ │                                    [패키지 상세] [신청]  │ │
│ └──────────────────────────────────────────────────────────┘ │
└──────────────────────────────────────────────────────────────┘
```

### 3. 확장된 필터링 시스템

#### 3.1 고급 필터 패널
```
┌─────────────────────────────────────────────────────────────┐
│ 🔍 고급 검색 필터                                          │
├─────────────────────────────────────────────────────────────┤
│ 기본 필터:                                                  │
│ [이름/전화] [____________________] [검색]                   │
│                                                             │
│ 서비스 이용 필터:                                           │
│ 최근 방문: [1주일▼] [1개월▼] [3개월▼] [6개월▼] [1년▼]     │
│ 이용 서비스: ☐브레인 ☐펄스 ☐림프 ☐레드 ☐AI바이크         │
│ 방문 빈도: [전체▼] [주1회이상▼] [월2회이상▼] [비정기▼]     │
│                                                             │
│ 패키지 필터:                                                │
│ 패키지 상태: [전체▼] [활성▼] [만료임박▼] [만료▼]          │
│ 패키지 등급: [전체▼] [기본▼] [프리미엄▼] [VIP▼]           │
│                                                             │
│ 고객 분류:                                                  │
│ 멤버십: [전체▼] [신규▼] [일반▼] [우수▼] [VIP▼]             │
│ 위험도: [전체▼] [안정▼] [주의▼] [이탈위험▼]                │
│                                                             │
│                      [필터 초기화] [필터 적용]              │
└─────────────────────────────────────────────────────────────┘
```

### 4. 대시보드 위젯 통합

#### 4.1 고객 현황 위젯
```
┌─────────────────────────────────────────────────────────────┐
│ 👥 고객 현황 요약                           📅 오늘 날짜   │
├─────────────────────────────────────────────────────────────┤
│ ┌──────────────┐ ┌──────────────┐ ┌──────────────┐ ┌─────┐ │
│ │ 전체 고객    │ │ 신규 고객    │ │ 활성 고객    │ │VIP │ │
│ │   1,247명    │ │    23명      │ │   892명      │ │84명│ │
│ │   (+15)      │ │   (이번주)   │ │   (이번달)   │ │    │ │
│ └──────────────┘ └──────────────┘ └──────────────┘ └─────┘ │
├─────────────────────────────────────────────────────────────┤
│ 🔥 오늘의 예약                                              │
│ • 10:00 김영희 (브레인) • 11:30 박철수 (펄스)              │
│ • 14:00 이민수 (림프)   • 16:00 정미영 (레드)              │
└─────────────────────────────────────────────────────────────┘
```

#### 4.2 서비스 이용 통계 위젯
```
┌─────────────────────────────────────────────────────────────┐
│ 📊 서비스별 이용 현황 (이번 달)                             │
├─────────────────────────────────────────────────────────────┤
│ 브레인   ████████████████████████████████████ 342회 (35%)   │
│ 펄스     ██████████████████████████ 267회 (27%)             │
│ 림프     ██████████████████ 189회 (19%)                     │
│ 레드     ████████████ 124회 (13%)                           │
│ AI바이크 ██████ 58회 (6%)                                   │
├─────────────────────────────────────────────────────────────┤
│ 💰 매출 기여도                        📈 성장률             │
│ 브레인: 2,736만원 (34%)               브레인: +12%          │
│ 펄스: 1,602만원 (20%)                 펄스: +8%            │
│ 프리미엄 패키지: 3,680만원 (46%)       패키지: +15%         │
└─────────────────────────────────────────────────────────────┘
```

---

## 🛠️ 기술 사양

### 1. 데이터베이스 스키마 확장

#### 1.1 customers 테이블 확장
```sql
ALTER TABLE customers ADD COLUMN (
  birth_year INTEGER,
  gender VARCHAR(10),
  email VARCHAR(100),
  address TEXT,
  emergency_contact VARCHAR(100),
  occupation VARCHAR(50),
  membership_level VARCHAR(20) DEFAULT 'basic',
  customer_status VARCHAR(20) DEFAULT 'active',
  preferred_time_slots JSON,
  health_goals TEXT,
  last_visit_date DATE,
  total_visits INTEGER DEFAULT 0,
  average_visit_interval INTEGER,
  total_revenue DECIMAL(10,2) DEFAULT 0,
  average_satisfaction DECIMAL(3,2),
  risk_level VARCHAR(20) DEFAULT 'stable'
);
```

#### 1.2 새로운 테이블 (기존 enhanced_service 모델 활용)
- `service_sessions`: 이미 구현됨
- `enhanced_package_usage`: 이미 구현됨
- `customer_service_preferences`: 이미 구현됨

### 2. API 엔드포인트 확장

#### 2.1 고객 상세 정보 API
```typescript
// GET /api/v1/customers/{id}/detail
interface CustomerDetailResponse {
  customer: CustomerExtended;
  serviceHistory: ServiceSession[];
  packageUsages: PackageUsage[];
  preferences: CustomerPreferences;
  analytics: CustomerAnalytics;
  recommendations: ServiceRecommendation[];
}
```

#### 2.2 고객 분석 API
```typescript
// GET /api/v1/customers/{id}/analytics
interface CustomerAnalytics {
  visitPattern: VisitPattern;
  serviceUsage: ServiceUsageStats;
  satisfactionTrend: SatisfactionTrend;
  revenueContribution: RevenueStats;
  healthMetrics: HealthMetrics;
}
```

### 3. 프론트엔드 컴포넌트 구조

```
src/
├── components/
│   ├── customers/
│   │   ├── CustomerDetailModal.tsx      # 새로 추가
│   │   ├── tabs/
│   │   │   ├── BasicInfoTab.tsx
│   │   │   ├── ServiceHistoryTab.tsx
│   │   │   ├── PackageManagementTab.tsx
│   │   │   ├── PreferencesTab.tsx
│   │   │   ├── AnalyticsTab.tsx
│   │   │   └── RecommendationsTab.tsx
│   │   ├── widgets/
│   │   │   ├── PackageUsageWidget.tsx
│   │   │   ├── ServiceHistoryWidget.tsx
│   │   │   ├── SatisfactionChart.tsx
│   │   │   └── RecommendationCard.tsx
│   │   ├── CustomerTable.tsx            # 확장
│   │   ├── CustomerFilters.tsx          # 확장
│   │   └── CustomerSearch.tsx           # 확장
├── hooks/
│   ├── useCustomerDetail.ts             # 새로 추가
│   ├── useCustomerAnalytics.ts          # 새로 추가
│   └── useServiceRecommendations.ts     # 새로 추가
└── types/
    ├── customer-extended.ts             # 새로 추가
    └── analytics.ts                     # 새로 추가
```

---

## 📅 개발 로드맵

### Phase 1: 기본 확장 (2주)
- [x] 고객 테이블에 서비스 요약 정보 추가
- [ ] CustomerDetailModal 컴포넌트 생성
- [ ] 기본정보 및 서비스이력 탭 구현
- [ ] 기존 API에 고객 상세 정보 엔드포인트 추가

### Phase 2: 패키지 통합 (2주)
- [ ] 패키지관리 탭 구현
- [ ] 패키지 사용률 시각화
- [ ] 패키지 갱신 알림 시스템
- [ ] 확장된 필터링 시스템

### Phase 3: 분석 및 추천 (3주)
- [ ] 고객 분석 대시보드
- [ ] 서비스 추천 알고리즘
- [ ] 만족도 트렌드 분석
- [ ] 개인화된 스케줄 추천

### Phase 4: 고급 기능 (2주)
- [ ] 고객 세그멘테이션
- [ ] 이탈 위험 고객 예측
- [ ] 자동화된 마케팅 추천
- [ ] 고급 리포팅 기능

---

## 🎯 성공 지표

### 1. 사용성 지표
- 고객 정보 조회 시간: 50% 단축
- 서비스 예약 완료율: 85% → 95%
- 직원 업무 효율성: 30% 향상

### 2. 비즈니스 지표
- 고객 재방문율: 65% → 80%
- 패키지 갱신율: 70% → 85%
- 고객 만족도: 4.2 → 4.7

### 3. 기술 지표
- 페이지 로딩 시간: 2초 이내
- API 응답 시간: 500ms 이내
- 에러율: 1% 이하

---

## 🔒 보안 고려사항

### 1. 개인정보 보호
- 고객 건강 정보 암호화
- 접근 권한 레벨별 정보 제한
- 개인정보 조회 로그 기록

### 2. 데이터 무결성
- 서비스 이력 변경 불가 설정
- 패키지 사용량 실시간 동기화
- 중복 결제 방지 로직

### 3. 사용자 권한
- 직원 레벨별 기능 접근 제한
- 고객 정보 수정 권한 관리
- 민감 정보 마스킹 처리

---

## 📖 용어 정의

- **확장 서비스**: 브레인, 펄스, 림프, 레드, AI바이크 5가지 전문 서비스
- **패키지 사용률**: 구매한 패키지 대비 실제 이용한 서비스 비율
- **방문 주기**: 고객의 평균적인 재방문 간격 (일 단위)
- **만족도 점수**: 서비스 완료 후 고객이 평가한 1-5점 만족도
- **이탈 위험도**: AI 분석을 통한 고객 이탈 가능성 예측 점수

---

## 📚 참고 자료

1. <!-- [기존 고객관리 시스템 분석](./customer-analysis.md) - 파일 없음 -->
2. [확장 서비스 PRD](./prd-updated.md)
3. [데이터베이스 설계](./database-schema.md)
4. <!-- [UI/UX 가이드라인](./ui-guidelines.md) - 파일 없음 -->
5. [개발 가이드라인](../CLAUDE.md)

---

*이 문서는 고객관리 시스템의 확장을 위한 상세 설계서입니다. 구현 전 팀 리뷰 및 승인이 필요합니다.*
