# 엑셀-데이터베이스 데이터 일치성 검증 보고서

검증 일시: 2025-06-25

## 요약

엑셀 파일과 데이터베이스 간의 데이터 일치성을 검증한 결과, 다음과 같은 차이점이 발견되었습니다:

- **전체 레코드 수**: 엑셀 99건 vs DB 103건 (4건 차이)
- **전체 금액**: 엑셀 100,360,710원 vs DB 96,712,710원 (3,648,000원 차이)
- **주요 원인**: 중복 데이터 및 수동 입력 데이터의 혼재

## 상세 분석 결과

### 1. 데이터 소스별 통계

DB에 저장된 2025년 1-5월 결제 데이터는 총 216건이며, 이 중:
- **엑셀 업로드 데이터**: 103건, 96,712,710원
- **수동 입력 데이터**: 113건, 137,183,780원

### 2. 월별 레코드 수 비교

| 월 | 엑셀 | DB (엑셀 업로드) | 차이 | 비고 |
|---|---:|---:|---:|---|
| 1월 | 14건 | 16건 | +2건 | 송선경 중복 데이터 |
| 2월 | 13건 | 14건 | +1건 | 김수현(남) 추가 데이터 |
| 3월 | 21건 | 21건 | 0건 | 일치 |
| 4월 | 20건 | 21건 | +1건 | 추가 데이터 존재 |
| 5월 | 31건 | 31건 | 0건 | 일치 |

### 3. 불일치 원인 분석

#### 3.1 중복 결제 데이터
- 총 40건의 중복 결제가 발견됨
- 동일한 고객이 같은 날짜에 여러 번 결제한 것으로 기록
- 주요 중복 사례:
  - 송선경 (2025-01-09): 2건의 마이너스 결제
  - 김보경 (2025-01-13): 전체 결제대장과 1월 시트에서 중복
  - 장재미: 여러 월에 걸쳐 중복 업로드

#### 3.2 금액 차이 분석
- **엑셀 총액**: 100,360,710원
- **DB 엑셀 업로드 총액**: 96,712,710원
- **차이**: 3,648,000원

차이가 발생한 주요 원인:
1. 일부 데이터가 엑셀 업로드 시 누락됨
2. 김준호의 데이터가 엑셀에는 있으나 DB 엑셀 업로드에는 없음
3. 마이너스 금액 처리 과정에서의 차이

### 4. 권장 조치사항

#### 4.1 즉시 조치 필요
1. **중복 데이터 정리**
   - 동일 고객, 동일 날짜의 중복 결제 확인 및 정리
   - 특히 "전체 결제대장"과 월별 시트에서 중복 업로드된 데이터 제거

2. **누락 데이터 확인**
   - 김준호 고객의 엑셀 데이터가 DB에 정상 업로드되었는지 확인
   - 3,648,000원의 금액 차이 원인 추적

#### 4.2 시스템 개선 사항
1. **중복 방지 로직 강화**
   - 엑셀 업로드 시 고객명+날짜+금액으로 중복 체크
   - 이미 존재하는 데이터는 업로드 방지

2. **데이터 검증 프로세스**
   - 엑셀 업로드 후 자동으로 합계 금액 비교
   - 차이 발생 시 경고 메시지 표시

3. **데이터 소스 구분**
   - 엑셀 업로드와 수동 입력 데이터를 명확히 구분
   - UI에서 데이터 소스별 필터링 기능 제공

### 5. 현재 데이터 상태

- DB에는 엑셀 데이터 외에도 113건의 수동 입력 데이터가 존재
- 수동 입력 데이터를 포함한 전체 금액: 233,896,490원
- 엑셀 업로드 데이터만의 금액: 96,712,710원

## 결론

현재 데이터베이스와 엑셀 파일 간에는 약간의 불일치가 존재하나, 대부분의 데이터는 정상적으로 동기화되어 있습니다.
발견된 중복 데이터와 누락 데이터를 정리하면 완전한 동기화가 가능할 것으로 판단됩니다.
